## Документация API

### 1. Пользовательские функции

**1.1. Регистрация и проверка пользователей**

| Функция                                  | Описание                                   | Параметры                                                                                         | Возвращаемое значение                           |
|------------------------------------------|--------------------------------------------|---------------------------------------------------------------------------------------------------|-------------------------------------------------|
| `checkUser(chatId)`                      | Проверяет наличие пользователя по ID чата. | `chatId` - ID чата пользователя.                                                                  | Объект с информацией о пользователе.            |
| `addUser(userId, cleanedText, username)` | Добавляет нового пользователя.             | `userId` - ID пользователя; `cleanedText` - ФИО пользователя; `username` - username пользователя. | Объект с информацией о добавлении пользователя. |

**1.2. Получение информации о платежах**

| Функция                               | Описание                                             | Параметры                                                       | Возвращаемое значение                                                      |
|---------------------------------------|------------------------------------------------------|-----------------------------------------------------------------|----------------------------------------------------------------------------|
| `getAllPayments()`                    | Возвращает список всех платежей.                     |                                                                 | Массив объектов с информацией о платежах.                                  |
| `updatePayments(sentIds)`             | Обновляет статус платежей.                           | `sentIds` - массив ID платежей, которые были отправлены.        | Объект с информацией об обновлении статуса платежей.                       |
| `getLastPaymentForUser(userId, date)` | Получает информацию о последнем платеже пользователя | `userId` - ID пользователя, `date` - дата для получения платежа | Объект с информацией о последнем платеже, или `null` если платеж не найден |

**1.3. Получение информации о чате**

| Функция                         | Описание                                 | Параметры           | Возвращаемое значение                                  |
|---------------------------------|------------------------------------------|---------------------|--------------------------------------------------------|
| `getChatInfo(chatId)`           | Возвращает информацию о чате.            | `chatId` - ID чата. | Объект с информацией о чате.                           |
| `getChatMembersCount(chatId)`   | Возвращает количество участников в чате. | `chatId` - ID чата. | Число участников в чате.                               |
| `getChatAdministrators(chatId)` | Возвращает список администраторов чата.  | `chatId` - ID чата. | Массив объектов с информацией об администраторах чата. |

### 2. Системные функции

**2.1. Проверка и обновление бота**

| Функция                                            | Описание                              | Параметры                                                                                                                                               | Возвращаемое значение                                      |
|----------------------------------------------------|---------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
| `checkBotData(formattedDateTime, instanceNumber)`  | Проверяет актуальность данных о боте. | `formattedDateTime` - текущая дата и время в формате "YYYY-MM-DD HH:mm:ss"; `instanceNumber` - случайное число, уникальное для каждого экземпляра бота. | Объект с информацией о последнем обновлении данных о боте. |
| `updateBotData(formattedDateTime, instanceNumber)` | Обновляет данные о боте.              | `formattedDateTime` - текущая дата и время в формате "YYYY-MM-DD HH:mm:ss"; `instanceNumber` - случайное число, уникальное для каждого экземпляра бота. | Объект с информацией об успешном обновлении данных о боте. |

**2.2. Метрики**

| Функция              | Описание                                      | Параметры | Возвращаемое значение                       |
|----------------------|-----------------------------------------------|-----------|---------------------------------------------|
| `fetchMetrics()`     | Возвращает актуальные метрики.                |           | Массив объектов с данными о метриках.       |
| `getMetricsMaster()` | Возвращает актуальные метрики для мастера.    |           | Объект с данными о метриках для мастера.    |
| `getMetricsNach()`   | Возвращает актуальные метрики для начальника. |           | Объект с данными о метриках для начальника. |

**2.3. Комментарии**

| Функция                                     | Описание                             | Параметры                                                                          | Возвращаемое значение                           |
|---------------------------------------------|--------------------------------------|------------------------------------------------------------------------------------|-------------------------------------------------|
| `getAllComments()`                          | Возвращает список всех комментариев. |                                                                                    | Массив объектов с информацией о комментариях.   |
| `updateComment(taskID, commentText = null)` | Обновляет комментарий к задаче.      | `taskID` - ID задачи; `commentText` - текст комментария (необязательный параметр). | Объект с информацией об обновлении комментария. |

**2.4. Фотографии**

| Функция                                                | Описание                       | Параметры                                                                                                                      | Возвращаемое значение                         |
|--------------------------------------------------------|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
| `addPhotoData(user_id, party, comments_otk, location)` | Добавляет данные о фотографии. | `user_id` - ID пользователя; `party` - номер партии; `comments_otk` - комментарий ОТК; `location` - местоположение фотографии. | Объект с информацией о добавлении фотографии. |

**2.5. Логирование**

| Функция                | Описание                                  | Параметры                                        | Возвращаемое значение |
|------------------------|-------------------------------------------|--------------------------------------------------|-----------------------|
| `sendLogData(logData)` | Отправляет данные лога на внешний ресурс. | `logData` - объект с данными для отправки в лог. |                       |

### 3. Переменные окружения

| Переменная   | Описание                               |
|--------------|----------------------------------------|
| `SECRET_KEY` | Секретный ключ для аутентификации API. |
| `BOT_TOKEN`  | Токен бота Telegram.                   |
| `WEB_API`    | Базовый URL API.                       |

### 4. Использование API

* Перед использованием API необходимо получить секретный ключ и токен бота Telegram.
* Все запросы к API должны содержать заголовок `Authorization` с секретным ключом.
* Методы API могут возвращать разные типы данных: JSON, HTML, текст.


